<div class="modal-body">
  <div class="dialog-header">
    <button type="button" class="close" ng-click="cancel()">
      <i class="iconfont icon-guanbi"></i>
    </button>
    <div class="dialog-title">插入图片</div>
  </div>
  <div class="km-tabs">
    <div
      class="km-tab"
      ng-click="toggleTab(tabs.upload)"
      ng-class="{active: activeTab === tabs.upload}"
    >
      上传图片
    </div>
    <div
      class="km-tab"
      ng-click="toggleTab(tabs.link)"
      ng-class="{active: activeTab === tabs.link}"
    >
      在线图片
    </div>
  </div>
  <form ng-show="activeTab === tabs.upload">
    <div class="form-group">
      <!-- 这里不能用 ng-change -->
      <input
        type="file"
        name="upload-image"
        id="upload-image"
        class="upload-image"
        accept=".jpg,.JPG,jpeg,JPEG,.png,.PNG,.gif,.GIF"
        onchange="angular.element(this).scope().uploadImage()"
      />
      <label for="upload-image" class="select-file-btn km-btn km-btn-primary"><span>选择文件</span></label>
    </div>
    <div class="form-group image-preview-box">
      <span ng-show="!data.url" class="image-preview-label">图片预览区域</span>
      <img
        class="image-preview"
        id="image-preview"
        ng-src="{{ data.url }}"
        alt="{{ data.title }}"
      />
    </div>
    <div class="form-group" ng-class="{'has-success' : titlePassed}">
      <input
        type="text"
        class="form-control"
        ng-model="data.title"
        ng-blur="titlePassed = true"
        id="image-title"
        placeholder="选填：鼠标在图片上悬停时提示的文本"
      />
    </div>
  </form>
  <form ng-show="activeTab === tabs.link">
    <div class="form-group" ng-class="{true: 'has-success', false: 'has-error'}[urlPassed]">
      <input
        type="text"
        class="form-control"
        ng-model="data.url"
        ng-blur="urlPassed = data.R_URL.test(data.url)"
        ng-focus="this.value = data.url"
        ng-keydown="shortCut($event)"
        id="image-url"
        placeholder="必填：请复制图片地址（http(s)://开头）到这里"
      />
    </div>
    <div class="form-group image-preview-box">
      <span ng-show="!data.url" class="image-preview-label">图片预览区域</span>
      <img
        class="image-preview"
        id="image-preview"
        ng-src="{{ data.url }}"
        alt="{{ data.title }}"
      />
    </div>
    <div class="form-group" ng-class="{'has-success' : titlePassed}">
      <input
        type="text"
        class="form-control"
        ng-model="data.title"
        ng-blur="titlePassed = true"
        id="image-title"
        placeholder="选填：鼠标在图片上悬停时提示的文本"
      />
    </div>
  </form>
  <div class="km-btns">
    <button class="km-btn km-btn-default" ng-click="cancel()">取消</button>
    <button class="km-btn km-btn-primary" ng-click="ok()">确定</button>
  </div>
</div>
